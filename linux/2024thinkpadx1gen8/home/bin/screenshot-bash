#!/usr/bin/env bash
#    screenshot-bash
#    Copyright (C) 2017-2021 Sefa Eyeoglu <contact@scrumplex.net> (https://scrumplex.net)
#
#    This program is free software: you can redistribute it and/or modify
#    it under the terms of the GNU General Public License as published by
#    the Free Software Foundation, either version 3 of the License, or
#    (at your option) any later version.
#
#    This program is distributed in the hope that it will be useful,
#    but WITHOUT ANY WARRANTY; without even the implied warranty of
#    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
#    GNU General Public License for more details.
#
#    You should have received a copy of the GNU General Public License
#    along with this program.  If not, see <https://www.gnu.org/licenses/>.
set -e

do_screenshot() {
    grim -g "$(slurp)" "$1"
}

copy_clipboard() {  # Wayland
    wl-copy -- "$1"
}

dialog_error ()
{
    >&2 echo "$@"
    if [ -x "$(command -v kdialog)" ]; then
        kdialog --title "screenshot-bash" --error "$@"
    else
        >&2 echo ""
        >&2 echo "Aditionally kdialog is not installed."
    fi
}

play_sound () # play ogg file (gzipped and encoded in base64)
{
    echo "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" | base64 -d | gzip -d -c | play -
}



config_path="${XDG_CONFIG_HOME:-$HOME/.config}/screenshot-bash.conf"

if [ -n "$SCREENSHOT_BASH_CONFIG_PATH" ]; then
    config_path="$SCREENSHOT_BASH_CONFIG_PATH"
fi

_errors_found=0

if [ ! -f "$config_path" ]; then

    dialog_error "Configuration file not found at $config_path"

    _errors_found=1

fi


if [ ! -x "$(command -v upload-bash)" ]; then

    dialog_error "upload-bash not found in \$PATH. Please check your installation."

    _errors_found=1

fi

if [ $_errors_found -gt 0 ]; then
    exit 1
fi

# shellcheck source=screenshot-bash.conf
source "$config_path"

upload_enabled=0

if [ -n "$TARGET_HOST" ] && [ -n "$PASSWORD" ]; then
    upload_enabled=1
fi

# create screenshot
do_screenshot "$TARGET_FILENAME"


if [ ! -f "$TARGET_FILENAME" ]; then
    # file was not saved (no screenshot taken)
    exit 2 # nothing to do
fi


result_url="file://$(realpath "$TARGET_FILENAME")"

if [ $upload_enabled -gt 0 ]; then

    set +e

    result_url=$(upload-bash "$TARGET_FILENAME")

    if [ ! $? -eq 0 ]; then
        dialog_error "Uploading failed: $result_url"
        exit 1
    fi
    set -e

fi

xdg-open "$result_url" & # Open url
disown

copy_clipboard "$(echo "$result_url" | tr -d '\n')"
play_sound > /dev/null 2>&1
echo "$result_url"
